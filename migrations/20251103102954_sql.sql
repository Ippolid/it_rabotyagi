-- +goose Up
-- Добавляем технологии
INSERT INTO technologies (id, name)
VALUES
    (1, 'Go'),
    (2, 'Python'),
    (3, 'PostgreSQL')
ON CONFLICT (id) DO NOTHING;


-- Вопросы по Go
INSERT INTO questions (id, title, content, difficulty, options, correct_answer, explanation)
VALUES
    (1, 'Что делает оператор := в Go?', 'Выберите правильный вариант использования.', 'easy',
     '["Объявляет и инициализирует переменную", "Создает указатель", "Определяет структуру"]'::jsonb,
     'Объявляет и инициализирует переменную',
     'Оператор := используется для краткого объявления и инициализации переменной.'),
    (2, 'Как запустить горутину?', 'Как запустить функцию myFunc() в отдельной горутине?', 'easy',
     '["goroutine myFunc()", "start myFunc()", "go myFunc()"]'::jsonb,
     'go myFunc()',
     'Ключевое слово go запускает функцию в отдельной горутине.'),
    (3, 'Когда выполняется функция, объявленная с defer?', 'Выберите правильный ответ.', 'medium',
     '["Сразу при вызове", "После выхода из функции", "Перед каждой итерацией"]'::jsonb,
     'После выхода из функции',
     'defer выполняет функцию в конце выполнения текущей.'),
    (4, 'Что произойдет при отправке в nil-канал?', 'Какое поведение будет у Go?', 'hard',
     '["Паника", "Блокировка", "Ничего не произойдет"]'::jsonb,
     'Блокировка',
     'Операция с nil-каналом блокирует горутину навсегда.'),
    (5, 'Какое значение по умолчанию имеет bool?', 'Что возвращает неинициализированный bool?', 'easy',
     '["true", "false", "nil"]'::jsonb,
     'false',
     'В Go все переменные имеют нулевое значение по типу, bool — false.')
ON CONFLICT (id) DO NOTHING;

-- Вопросы по Python
INSERT INTO questions (id, title, content, difficulty, options, correct_answer, explanation)
VALUES
    (6, 'Что делает оператор *args?', 'Выберите правильный ответ.', 'medium',
     '["Передает любое количество позиционных аргументов", "Передает словарь именованных аргументов", "Создает список аргументов"]'::jsonb,
     'Передает любое количество позиционных аргументов',
     '*args позволяет функции принимать любое количество позиционных аргументов.'),
    (7, 'Что делает **kwargs?', 'Выберите правильное описание.', 'medium',
     '["Передает словарь именованных аргументов", "Передает кортеж", "Передает список"]'::jsonb,
     'Передает словарь именованных аргументов',
     '**kwargs собирает именованные аргументы функции в словарь.'),
    (8, 'Что делает оператор is?', 'Чем отличается от == ?', 'medium',
     '["Сравнивает значения", "Сравнивает идентичность объектов"]'::jsonb,
     'Сравнивает идентичность объектов',
     'Оператор is проверяет, указывают ли переменные на один и тот же объект в памяти.'),
    (9, 'Что выведет print(0.1 + 0.2 == 0.3)?', 'Результат выполнения выражения?', 'hard',
     '["True", "False"]'::jsonb,
     'False',
     'Из-за погрешности представления чисел с плавающей точкой.'),
    (10, 'Что делает list(range(3))?', 'Что будет результатом?', 'easy',
     '["[1,2,3]", "[0,1,2]", "[0,1,2,3]"]'::jsonb,
     '[0,1,2]',
     'range(3) возвращает последовательность 0, 1, 2.')
ON CONFLICT (id) DO NOTHING;

-- Вопросы по PostgreSQL
INSERT INTO questions (id, title, content, difficulty, options, correct_answer, explanation)
VALUES
    (11, 'Что делает COALESCE?', 'Выберите правильное определение.', 'easy',
     '["Возвращает первое ненулевое значение", "Удаляет NULL", "Суммирует"]'::jsonb,
     'Возвращает первое ненулевое значение',
     'COALESCE возвращает первый аргумент, не равный NULL.'),
    (12, 'Что делает EXPLAIN?', 'Для чего используется?', 'medium',
     '["Показывает план выполнения", "Удаляет таблицу", "Создает индекс"]'::jsonb,
     'Показывает план выполнения',
     'EXPLAIN отображает план выполнения SQL-запроса.'),
    (13, 'Что делает SERIAL?', 'Выберите верное описание.', 'easy',
     '["Создает автоинкрементное поле", "Создает массив"]'::jsonb,
     'Создает автоинкрементное поле',
     'SERIAL создает последовательность и связывает ее с колонкой.'),
    (14, 'Что делает VACUUM?', 'Для чего используется VACUUM?', 'medium',
     '["Очищает таблицы и освобождает место", "Удаляет базу данных"]'::jsonb,
     'Очищает таблицы и освобождает место',
     'VACUUM удаляет “мертвые” строки, освобождая место.'),
    (15, 'Что делает команда ANALYZE?', 'Выберите верный ответ.', 'medium',
     '["Собирает статистику о таблице", "Удаляет индекс", "Создает схему"]'::jsonb,
     'Собирает статистику о таблице',
     'ANALYZE обновляет статистику для оптимизатора запросов.')
ON CONFLICT (id) DO NOTHING;


-- Связи вопросов с технологиями
INSERT INTO question_technologies (question_id, technology_id)
VALUES
    (1, 1), (2, 1), (3, 1), (4, 1), (5, 1),
    (6, 2), (7, 2), (8, 2), (9, 2), (10, 2),
    (11, 3), (12, 3), (13, 3), (14, 3), (15, 3)
ON CONFLICT DO NOTHING;

-- +goose Down
DELETE FROM question_technologies WHERE question_id BETWEEN 1 AND 15;
DELETE FROM questions WHERE id BETWEEN 1 AND 15;
DELETE FROM technologies WHERE id IN (1, 2, 3);
